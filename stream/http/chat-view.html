<!DOCTYPE html>
<head>
    <title>Live Chat View</title>

    <!-- Import the emote parser CSS -->
    <link rel="stylesheet" href="chat.css">

    <!-- Import the emote parser -->
    <script src="parser.js"></script>

    <!-- Main Script -->
    <script>

// Create a new message parser
const messageParser = new ChatMessageParser();

// Load external data, i.e. emotes
messageParser.load();

function json_read(chat_data)
{
    if(chat_data.length ==0)
    {
      return
    }

    chat_list = document.getElementById("chat-list");
    chat_list.textContent = '';

    chat_data.forEach((c) => {
        li = document.createElement("li");

        var name = document.createElement("span");
        name.innerHTML = c['from'];
        name.style.color = c['color'];
        name.classList.add("name");
        li.appendChild(name)

        // Use the emote parser to parse the message
        var text = messageParser.parseSafe(c['text']);
        li.appendChild(text)

        chat_list.appendChild(li)
    });

}

function data_fetch()
{
  fetch('chat.json')
    .then((response) => response.json())
    .then((data) => json_read(data));

  setTimeout(data_fetch,1000)
}
setTimeout(data_fetch,1000)

    </script>
</head>
<body>
    <div id="chat-container">
        <ul id="chat-list">
        </ul>
    </div>
</body>
